<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>BlackJack</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        /* Vue ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚Œã‚‹ã¾ã§éè¡¨ç¤ºã«ã™ã‚‹ */
        [v-cloak] {
            display: none;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ç”»é¢ -->
        <div v-if="currentPage === 'register'">
            <h2>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²</h2>
            <input id="username" v-model="username" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
            <button @click="registerUser">ç™»éŒ²</button>
            <p>{{ message }}</p>
        </div>

        <!-- ã‚¹ãƒ†ãƒ¼ã‚¸é¸æŠç”»é¢ -->
        <div v-if="currentPage === 'stageSelect'" class="stage-select-container">
            <div class="user-info">
                <p>{{ username }}ã•ã‚“</p>
                <button @click="deleteUser">ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤</button>
            </div>

            <h2>ã‚¹ãƒ†ãƒ¼ã‚¸é¸æŠ</h2>
            <div class="stages">
                <button
                    v-for="stage in 9"
                    :key="stage"
                    :disabled="!stages[stage]"
                    @click="selectStage(stage)">
                    {{ stage }} <span v-if="!stages[stage]">ğŸ”’</span>
                </button>
            </div>

            <div class="export-button">
                <button @click="exportUserData">çµæœå‡ºåŠ›</button>
            </div>
        </div>

        <!-- ã‚²ãƒ¼ãƒ ç”»é¢ -->
        <div v-if="currentPage === 'game'">
            <h2>Stage {{ selectedStage }}</h2>

            <div class="dealer">
                <h3>Dealer <span class="life">{{ 'â¤ï¸'.repeat(dealerLife) }}</span></h3>
                <div class="cards">
                    <span v-for="(card, index) in dealerCards" :key="index" class="card">{{ card }}</span>
                </div>
                <p v-if="roundOver">Score: {{ dealerTotal }}</p>
            </div>

            <div class="player">
                <h3>{{ username }} <span class="life">{{ 'â¤ï¸'.repeat(playerLife) }}</span></h3>
                <div class="cards">
                    <span v-for="(card, index) in playerCards" :key="index" class="card">{{ card }}</span>
                </div>
                <p>Score: {{ playerTotal }}</p>
            </div>

            <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
            <div class="actions">
                <button @click="hit" :disabled="roundOver || gameOver">Hit</button>
                <button @click="stand" :disabled="roundOver || gameOver">Stand</button>
            </div>

            <!-- ãƒ©ã‚¦ãƒ³ãƒ‰çµæœ -->
            <div class="result" v-if="roundOver && !stageCleared && !gameOver">
                <p>{{ resultMessage }}</p>
                <button v-if="!gameOver" @click="nextRound">æ¬¡ã®ãƒ©ã‚¦ãƒ³ãƒ‰</button>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ -->
             <div class="stage-cleared" v-if="stageCleared">
                <p>{{ resultMessage }}</p>
                <button @click="backToStageSelect">ã‚¹ãƒ†ãƒ¼ã‚¸é¸æŠã«æˆ»ã‚‹</button>
            </div>

            <!-- ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ -->
            <div class="game-over" v-if="gameOver">
                <p>GameOver ãƒ©ã‚¤ãƒ•ãŒ0ã«ãªã‚Šã¾ã—ãŸã€‚</p>
                <button @click="backToStageSelect">ã‚¹ãƒ†ãƒ¼ã‚¸é¸æŠã«æˆ»ã‚‹</button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="/static/app.js"></script>
</body>
</html>
